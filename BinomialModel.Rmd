---
title: "Binomial Model Updating"
author: "Justin Mann"
date: "2023-09-23"
output: html_document
runtime: shiny
---


```{r libraries, include=FALSE}
library(tidyverse)
library(rethinking)
```

```{r setup, include=FALSE}
# install.packages(c("coda","mvtnorm","devtools","loo","dagitty","shape"))
# devtools::install_github("rmcelreath/rethinking")
# devtools::install_github("stan-dev/cmdstanr")
```


## Anthrops vs. Disconnectors

At the end of our Socratic debate, you voted on whether 1) anthropomorphism or 2) disconnection from our evolutionary roots was the bigger source of bias when studying animal communication.




```{r eruptions, echo=FALSE}
inputPanel(
  numericInput("n_W", label = "Anthropomorphism", 0, min = 0, max = 25),
  
  numericInput("n_L", label = "Disconnection", 0, min = 0, max = 25)
)

renderPlot({
W <- input$n_W
L <- input$n_L
curve(dbeta(x, W+1, L+1), from = 0, to = 1, xlab = "Proportion of votes (A/D)", ylab = "Density")
})
```



```{r binomial model plots}
# define grid
p_grid <- seq(from=0, to=1, length.out=20)

#define prior
prior <- rep(1,20)
prior <- ifelse(p_grid < 0.5, 0, 1)
prior <- exp(-5*abs(p_grid - 0.5))

# compute likelihood at each value in grid
likelihood <- dbinom(6, size = 9, prob = p_grid)

# compute product of likelihood and prior
unstd.posterior <- likelihood * prior

# standardize the posterior, so it sums to 1
posterior <- unstd.posterior/sum(unstd.posterior)

plot(p_grid, posterior, type="b", 
     xlab="probability of water", ylab="posterior probability")
mtext("20 points")

```


```{r stat rethinking R code 2.6}
globe.qa <- quap(
  alist(
    W ~ dbinom(W+L, p), # binomial likelihood
    p ~ dunif(0,1) # uniform prior
  ),
  data = list(W=6,L=3)
)
precis(globe.qa)
```


```{r stat rethinking R code 2.7}
# analytical calculation 
W <- 3
L <- 0

curve(dbeta(x, W+1, L+1), from = 0, to = 1, xlab = "Proportion of water", ylab = "Density")

```


